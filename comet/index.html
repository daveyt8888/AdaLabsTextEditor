<html> 
	<head>
		<title>Collaborative Text Editor</title>
		
		<!--jQuery-->
		<link rel="stylesheet" href="jquery-ui.css" type="text/css"/>		
		<script src="jquery.js"></script>
		<script src="jquery-ui.js"></script>
		<script>		
			$(function(){
				$( "#tabs" ).tabs();
			});			
		</script>
		
		<!--tinyMCE
		<script type="text/javascript" src="js/tiny_mce.js"></script>
		<script type="text/javascript">		
			tinyMCE.init({
				mode : "textareas",
       
				theme_advanced_buttons1 : "fontselect,fontsizeselect",
				theme_advanced_statusbar_location : "bottom",
				theme_advanced_resizing : true,
			});
		</script>-->
		
		<!--comet-->
		<script>
		
			var timestamp = null;
			
			function comet(){
				$.ajax({
				type : 'Get',
				url  : 'read.php?timestamp=' + timestamp,
				async : true,
				cache : false,
		
				success : function(response) { 				
					var json = eval('(' + response + ')');
					
						$('#send').html(json['msg']); //displaying on textarea
						$('#msg').animate({scrollTop: $('#msg').get(0).scrollHeight},200);
					
					timestamp  = json['timestamp'];
					setTimeout('comet()', 1000);
				},
				
				error : function(XMLHttpRequest, textstatus, error) { 
					alert(error);
					setTimeout('comet()', 15000);
				}		
			});
			}
		
			$(function(){
			
				comet();
				$('#send').bind('keypress', function(e) { //Use keypress to obtain charCode
				
				var msg = String.fromCharCode(e.charCode);
		
				$.ajax({
				type : 'GET',
				url  : 'write.php?msg='+ msg,
				async : true,
				cache : false
				});		
				})
			});
		</script>
	</head>
	
	<body>
		
		<div id="msg"> </div><br/>
	
			<div id="tabs">
			<ul>
				<li><a href="#tabs-1">Tab 1</a></li>
				<li><a href="#tabs-2">Tab 2</a></li>
			</ul>
		
			<div id="tabs-1">
				<textarea id="send" name="msg" cols="100"></textarea>	
			</div>
			
			<div id="tabs-2">
				<p>Tab2</p>
			</div>
		
		</div>		
	</body>
</html>
